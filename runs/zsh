#!/usr/bin/env bash
set -euo pipefail

if command -v pacman &>/dev/null; then
	sudo pacman -S --noconfirm --needed zsh
	hash -r
fi

# Install autosuggestions via git clone (single source of truth)
if [ ! -d "$HOME/.zsh/zsh-autosuggestions" ]; then
	git clone https://github.com/zsh-users/zsh-autosuggestions ~/.zsh/zsh-autosuggestions
else
	echo "[zsh] zsh-autosuggestions already installed"
fi

# Set zsh as default shell (non-interactive)
if [ "$SHELL" != "$(which zsh)" ]; then
	sudo chsh -s "$(which zsh)" "$USER"
fi
